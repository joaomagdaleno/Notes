# Lefthook configuration for local Git hooks
# To install: dart pub global activate lefthook && lefthook install

pre-commit:
  parallel: true
  commands:
    analyze:
      root: Notes-Hub/
      run: flutter analyze
    format:
      root: Notes-Hub/
      run: dart format --set-exit-if-changed .
    health-audit:
      run: dart scripts/check_health.dart
    dependency-audit:
      run: dart scripts/audit_dependencies.dart

pre-push:
  commands:
    analyze:
      root: Notes-Hub/
      run: flutter analyze
    format:
      root: Notes-Hub/
      run: dart format --set-exit-if-changed .
    test:
      root: Notes-Hub/
      run: flutter test
    coverage-guard:
      run: dart scripts/calculate_coverage.dart Notes-Hub/coverage/lcov.info 80

commit-msg:
  commands:
    conventional-commits:
      run: |
        grep -iqE "^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\(.+\))?!?: .+" {1} || \
        (echo "Error: Commit message doesn't follow Conventional Commits standard (e.g., 'feat: add feature')" && exit 1)
